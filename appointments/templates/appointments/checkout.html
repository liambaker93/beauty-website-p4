{% extends 'base.html' %}

{% load static %}
{% block extra_title %}
Checkout 
{% endblock %}
{% block content %}
<div class="container">
<div class="row">
    <div class="col-3">
        <div>Service: </div>
        <div>Cost: </div>
        <div>Time: </div>
        <div>Date: </div>
        <div>Deposit: </div>
    </div>
    <div class="col-3">
               
        <div>{{ appointment.service.name }}</div>
        <div>£{{ appointment.service.price }}</div>
        <div>{{ appointment.appointment_time }}</div>
        <div>{{ appointment.appointment_date }}</div>
        <div>£{{ appointment.deposit_cost }}</div>
    </div>
    <div class="col">
        <form id="payment-form" method="POST" action="{% url 'checkout_page' appointment.booking_id %}">
            {% csrf_token %}
            <input type="hidden" value="{{ stripe_public_key }}" name="id_stripe_public_key">
            <input type="hidden" value="{{ client_secret }}" name="id_client_secret">
            <div id="payment-element">
            </div>
            <button id="submit">
                <div class="spinner hidden" id="spinner"></div>
                <span id="button-text">Pay now</span>
            </button>
            <div id="payment-message" class="hidden"></div>
        </form>
    </div>
</div>
</div>

{% endblock %}
{% block postloadjs %}
{{ block.super }}
{{ stripe_public_key|json_script:"id_stripe_public_key" }}
{{ client_secret|json_script:"id_client_secret" }}
{{ appointment.service.name|json_script:"id_service_name" }}
{{ appointment.deposit_cost|json_script:"id_deposit_price" }}
{{ appointment.booking_id|json_script:"id_appointment_id" }}
<script src="{% static 'appointments/js/checkout.js' %}"></script>
{% endblock %}